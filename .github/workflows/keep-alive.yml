name: Keep Render.com Alive

# This workflow pings your Render.com app every 14 minutes to prevent it from sleeping
# Free tier Render apps sleep after 15 minutes of inactivity

on:
  schedule:
    # Runs every 14 minutes (Render free tier sleeps after 15 min of inactivity)
    - cron: '*/14 * * * *'
  workflow_dispatch: # Allows manual triggering

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    
    steps:
    - name: Ping Render Service
      run: |
        echo "üîÑ Pinging Render.com service to keep it alive..."
        echo "Time: $(date)"
        
        # Replace YOUR_APP_NAME with your actual Render app name
        # Example: https://image-background-remover.onrender.com
        RENDER_URL="${{ secrets.RENDER_URL }}"
        
        if [ -z "$RENDER_URL" ]; then
          echo "‚ö†Ô∏è  RENDER_URL secret not set. Please add it in GitHub repository settings."
          echo "Go to: Settings > Secrets and variables > Actions > New repository secret"
          echo "Name: RENDER_URL"
          echo "Value: https://your-app-name.onrender.com"
          exit 1
        fi
        
        # Make HTTP request to keep the app awake
        response=$(curl -s -o /dev/null -w "%{http_code}" --max-time 30 "$RENDER_URL" || echo "000")
        
        if [ "$response" = "200" ]; then
          echo "‚úÖ Success! App is alive (HTTP $response)"
        elif [ "$response" = "000" ]; then
          echo "‚ö†Ô∏è  Timeout or connection error - app might be starting up"
        else
          echo "‚ö†Ô∏è  Received HTTP $response (app might still be waking up)"
        fi
        
        echo "Next ping in 14 minutes..."
    
    - name: Log Status
      run: |
        echo "üìä Workflow Status:"
        echo "  - Workflow: ${{ github.workflow }}"
        echo "  - Run Number: ${{ github.run_number }}"
        echo "  - Triggered by: ${{ github.event_name }}"
